<!DOCTYPE html>
<html lang="en" class="light"> <!-- toggle class to 'dark' for dark mode -->
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Universal ATS Resume Builder Pro ‚Äì create ATS‚Äëfriendly resumes with real ATS score" />
  <title>Universal ATS Resume Builder Pro</title>

  <style>
    /* base reset + global */
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; }
    body { background: #f9fafb; color: #1f2937; line-height: 1.6; height: 100vh; overflow: hidden; }
    body.dark { background: #111827; color: #f9fafb; }
    h1, h2, h3, h4, h5, h6 { margin-bottom: 0.5rem; }
    button, input, textarea, select { padding: 0.5rem; border-radius: 0.375rem; border: 1px solid #d1d5db; font-size: 1em; }
    button { background: #2563eb; color: #fff; border: none; cursor: pointer; transition: 0.2s; }
    button:hover { background: #1d4ed8; }
    button.secondary { background: #e5e7eb; color: #374151; }
    button.secondary:hover { background: #d1d5db; }

    /* layout */
    .app {
      height: 100vh;
      display: grid;
      grid-template-columns: 240px 1fr 320px;
      gap: 1px;
    }
    .sidebar {
      background: #f1f5f9; padding: 1rem; display: flex; flex-direction: column; gap: 0.8rem;
    }
    .sidebar.dark { background: #1f2937; }
    .content {
      padding: 1.5rem; background: white; overflow-y: auto;
    }
    .content.dark { background: #1f2937; }
    .panel-right {
      background: #f3f4f6; padding: 1.5rem; overflow-y: auto;
    }
    .panel-right.dark { background: #1f2937; }

    /* form layout */
    .form-section {
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid #e5e7eb;
    }
    label { display: block; font-weight: 500; margin-bottom: 0.3rem; }
    input, textarea, select { width: 100%; padding: 0.6rem; margin-bottom: 0.6rem; }
    textarea { min-height: 100px; resize: vertical; }

    /* score meter */
    .meter-wrapper {
      text-align: center; margin-top: 1.5rem; position: relative; }
    .meter-base { width: 200px; height: 200px; border-radius: 50%; margin: 0 auto; position: relative; }
    .meter-fill { position: absolute; inset: 0; border-radius: 50%; clip-path: inset(0); }
    .meter-value { position: absolute; width: 60%; height: 60%; top: 20%; left: 20%; border-radius: 50%; background: white; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    .meter-value.dark { background: #1f2937; color: #e5e7eb; }
    .info-list { margin-top: 1rem; font-size: 0.875rem; color: #4b5563; }

    /* dark / light toggle */
    .mode-toggle { margin-top: auto; margin-bottom: 0; }

    /* tab buttons */
    .tab-header { display: flex; margin-bottom: 1rem; border-bottom: 1px solid #d1d5db; }
    .tab-header button {
      background: #e5e7eb; color: #1f2937;
      padding: 0.5rem 1rem; margin-right: 0.2rem; border: none;
      border-top-left-radius: 0.375rem; border-top-right-radius: 0.375rem;
      opacity: 0.9;
    }
    .tab-header button.active {
      background: #2563eb; color: #fff; opacity: 1;
    }

    /* resume preview */
    .resume-preview {
      max-width: 800px; margin: 0 auto; padding: 2rem; border: 1px solid #d1d5db; font-size: 0.9rem;
    }
    .resume-preview h2 { margin-top: 0.8rem; font-size: 1.1rem; }
    @media (max-width: 1024px) {
      .app { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- LEFT SIDEBAR -->
    <nav class="sidebar">
      <h2>ATS Resume Builder</h2>
      <button onclick="switchTab('builder')">üìù Resume Builder</button>
      <button onclick="switchTab('jd')">üìÑ Job Description</button>
      <button onclick="switchTab('preview')">üëÅÔ∏è Preview</button>

      <div class="mode-toggle">
        <button onclick="toggleDarkMode()">üåô Toggle Dark Mode</button>
      </div>
    </nav>

    <!-- CENTER CONTENT -->
    <main class="content">
      <!-- ---------- TAB: BUILDER ---------- -->
      <section id="tab-builder" class="form-container">
        <h1>Build ATS‚ÄëFriendly Resume</h1>
        <p>Create & edit your resume in real time.</p>

        <div class="form-section">
          <h3>Personal Info</h3>
          <label>Name</label>
          <input id="name" oninput="onUserInput()" />

          <label>Email</label>
          <input id="email" oninput="onUserInput()" />

          <label>Phone</label>
          <input id="phone" oninput="onUserInput()" />
        </div>

        <div class="form-section">
          <h3>Summary</h3>
          <textarea id="summary" placeholder="2‚Äì4 lines professional summary" oninput="onUserInput()"></textarea>
        </div>

        <div class="form-section">
          <h3>Skills</h3>
          <textarea id="skills" placeholder="JavaScript, React, Node.js, Leadership, Problem Solving (comma‚Äëseparated)" oninput="onUserInput()"></textarea>
        </div>

        <div class="form-section">
          <h3>Experience</h3>
          <textarea id="experience" placeholder="Company XYZ ‚Äì Software Engineer | 2019‚Äì2022 ‚Äì Built features, improved performance, led team‚Ä¶" oninput="onUserInput()"></textarea>
        </div>

        <div class="form-section">
          <h3>Projects</h3>
          <textarea id="projects" placeholder="E‚ÄëCommerce App ‚Äì React + Node ‚Äì Implemented checkout flow with 95% success rate" oninput="onUserInput()"></textarea>
        </div>

        <div class="form-section">
          <h3>Education</h3>
          <textarea id="education" oninput="onUserInput()"></textarea>
        </div>

        <div class="form-section">
          <h3>Certifications</h3>
          <textarea id="certifications" placeholder="AWS Certified, Google Analytics" oninput="onUserInput()"></textarea>
        </div>

        <button onclick="downloadResumePdf()">üì• Export Resume (PDF)</button>
      </section>

      <!-- ---------- TAB: JOB DESCRIPTION ---------- -->
      <section id="tab-jd" class="form-container" style="display: none;">
        <h1>Job Description Analyzer</h1>
        <p>Paste a job posting to calculate ATS match.</p>

        <div class="form-section">
          <label>Paste Job Description</label>
          <textarea id="jdText" placeholder="Paste job description text here‚Ä¶" oninput="recalculateAtsScore()"></textarea>
        </div>

        <div class="form-section">
          <label>Suggested keywords from JD (will be used in scoring):</label>
          <div id="jdKeywords">None yet.</div>
        </div>

        <button onclick="recalculateAtsScore()">üîÑ Recalculate ATS Score</button>
      </section>

      <!-- ---------- TAB: PREVIEW ---------- -->
      <section id="tab-preview" class="form-container" style="display: none;">
        <h1>Live Preview</h1>
        <div id="previewArea" class="resume-preview"></div>
      </section>
    </main>

    <!-- RIGHT PANEL ‚Äì SCORE METER -->
    <aside class="panel-right">
      <h2>ATS Score</h2>
      <div class="meter-wrapper">
        <div id="meterBase" class="meter-base"></div>
        <div id="meterValue" class="meter-value">0</div>
      </div>

      <h3>Breakdown</h3>
      <ul id="scoreBreakdown" class="info-list"></ul>

      <h3>Fix Suggestions</h3>
      <ul id="fixSuggestions" class="info-list"></ul>

      <div style="margin-top: 1.5rem;">
        <button onclick="downloadResumePdf()">üìÑ Download PDF</button>
        <!-- DOCX export not in this pure HTML prototype; use backend later -->
      </div>

      <p style="font-size: 0.75rem; margin-top: 1rem;">
        Analytics tracked locally for now. In production, send device/browsers to Supabase.
      </p>
    </aside>
  </div>

  <!-- SCRIPTS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    // store resume state
    const data = {
      name: "",
      email: "",
      phone: "",
      summary: "",
      skills: "",
      experience: "",
      projects: "",
      education: "",
      certifications: "",
      jdText: "",
      atsScore: 0,
      scoreBreakdown: {},
      fixSuggestions: []
    };

    // resume tabs
    function switchTab(tabId) {
      document.getElementById("tab-builder").style.display = "none";
      document.getElementById("tab-jd").style.display = "none";
      document.getElementById("tab-preview").style.display = "none";
      document.getElementById("tab-" + tabId).style.display = "block";
      if (tabId === "preview") renderResumePreview();
    }

    // fill inputs from data (or vice versa)
    function syncInputs() {
      ["name", "email", "phone", "summary", "skills", "experience", "projects", "education", "certifications", "jdText"].forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          if (data.hasOwnProperty(id)) {
            if (el.tagName === "INPUT" || el.tagName === "TEXTAREA") {
              if (!el.value && data[id]) el.value = data[id];
              data[id] = el.value;
            }
          }
        }
      });
    }

    // run anytime user edits anything
    function onUserInput() {
      clearTimeout(data.debouncedScoreTimer);
      syncInputs();
      data.debouncedScoreTimer = setTimeout(() => {
        recalculateAtsScore();
        renderResumePreview();
      }, 500); // debounce for UX
    }

    // toggle dark mode
    function toggleDarkMode() {
      const b = document.body;
      b.classList.toggle("dark");
    }

    // calculate ATS score from resume + JD
    function recalculateAtsScore() {
      syncInputs();
      const resumeText = [
        data.summary,
        data.skills,
        data.experience,
        data.projects,
        data.educ„Åï„Çâ„Å∏{"context":"continuing the provided incomplete HTML file and script implementation","role":"developer","title":"Complete ATS Resume Builder Pro Single‚ÄëFile HTML Implementation","tool_call_limit":0}
